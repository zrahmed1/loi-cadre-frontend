<div class="dashboard-container" role="region" aria-label="Dashboard">
  <h2>Dashboard</h2>
  <mat-spinner *ngIf="isLoading" aria-label="Loading dashboard"></mat-spinner>
  <div class="metrics-grid" *ngIf="!isLoading">
    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Effectif Summary</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div *ngIf="effectifChart">
          ```chartjs
          {{ effectifChart }}
          ```
        </div>
        <table
          mat-table
          [dataSource]="effectifSummaries"
          aria-describedby="Effectif Summary Table"
        >
          <ng-container matColumnDef="etablissementId">
            <th mat-header-cell *matHeaderCellDef>Etablissement ID</th>
            <td mat-cell *matCellDef="let summary">
              {{ summary.etablissementId }}
            </td>
          </ng-container>
          <ng-container matColumnDef="totalInitial">
            <th mat-header-cell *matHeaderCellDef>Total Initial</th>
            <td mat-cell *matCellDef="let summary">
              {{ summary.totalInitial }}
            </td>
          </ng-container>
          <ng-container matColumnDef="totalFinal">
            <th mat-header-cell *matHeaderCellDef>Total Final</th>
            <td mat-cell *matCellDef="let summary">{{ summary.totalFinal }}</td>
          </ng-container>
          <tr
            mat-header-row
            *matHeaderRowDef="['etablissementId', 'totalInitial', 'totalFinal']"
          ></tr>
          <tr
            mat-row
            *matRowDef="
              let row;
              columns: ['etablissementId', 'totalInitial', 'totalFinal']
            "
          ></tr>
          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="3">No effectif summaries found</td>
          </tr>
        </table>
      </mat-card-content>
    </mat-card>
    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Pending Mouvements</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>{{ pendingMouvementsCount }}</p>
        <mat-progress-bar
          mode="determinate"
          [value]="
            pendingMouvementsCount > 0
              ? (pendingMouvementsCount / 100) * 100
              : 0
          "
          aria-label="Pending mouvements progress"
        ></mat-progress-bar>
        <button
          mat-button
          color="primary"
          (click)="navigateTo('mouvements')"
          aria-label="View mouvements"
        >
          View Mouvements
        </button>
      </mat-card-content>
    </mat-card>
    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Loi Cadres by Status</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>Initiale: {{ loiCadresInitialeCount }}</p>
        <p>Envoee DB: {{ loiCadresEnvoeeDbCount }}</p>
        <p>Definitive: {{ loiCadresDefinitiveCount }}</p>
        <button
          mat-button
          color="primary"
          (click)="navigateTo('lois-cadres')"
          aria-label="View loi cadres"
        >
          View Loi Cadres
        </button>
      </mat-card-content>
    </mat-card>
    <mat-card class="metric-card">
      <mat-card-header>
        <mat-card-title>Total Utilisateurs</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>{{ totalUtilisateurs }}</p>
        <button
          mat-button
          color="primary"
          (click)="navigateTo('utilisateurs')"
          aria-label="View utilisateurs"
        >
          View Utilisateurs
        </button>
      </mat-card-content>
    </mat-card>
  </div>
</div>
