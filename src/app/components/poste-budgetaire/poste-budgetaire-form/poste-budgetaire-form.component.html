<form [formGroup]="posteForm" role="form" aria-label="Poste Budgetaire Form">
  <mat-form-field appearance="fill">
    <mat-label>Code Poste</mat-label>
    <input matInput formControlName="codePoste" aria-label="Poste code" />
    <mat-error *ngIf="posteForm.get('codePoste')?.hasError('required')"
      >Code Poste is required</mat-error
    >
    <mat-error *ngIf="posteForm.get('codePoste')?.hasError('pattern')"
      >Code Poste must be alphanumeric (A-Z, 0-9)</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Description</mat-label>
    <input
      matInput
      formControlName="description"
      aria-label="Poste description"
    />
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Effectif Initial</mat-label>
    <input
      matInput
      type="number"
      formControlName="effectifInitial"
      aria-label="Effectif initial"
    />
    <mat-error *ngIf="posteForm.get('effectifInitial')?.hasError('required')"
      >Effectif Initial is required</mat-error
    >
    <mat-error *ngIf="posteForm.get('effectifInitial')?.hasError('min')"
      >Effectif Initial must be at least 0</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Effectif Final</mat-label>
    <input
      matInput
      type="number"
      formControlName="effectifFinal"
      aria-label="Effectif final"
    />
    <mat-error *ngIf="posteForm.get('effectifFinal')?.hasError('required')"
      >Effectif Final is required</mat-error
    >
    <mat-error *ngIf="posteForm.get('effectifFinal')?.hasError('min')"
      >Effectif Final must be at least 0</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Etat</mat-label>
    <mat-select formControlName="etat" aria-label="Select poste etat">
      <mat-option *ngFor="let etat of etatPosteValues" [value]="etat">{{
        etat
      }}</mat-option>
    </mat-select>
    <mat-error *ngIf="posteForm.get('etat')?.hasError('required')"
      >Etat is required</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Loi Cadre</mat-label>
    <mat-select formControlName="loiCadreId" aria-label="Select loi cadre">
      <mat-option
        *ngFor="let loiCadre of loisCadres$ | async"
        [value]="loiCadre.id"
        >{{ loiCadre.annee }} (v{{ loiCadre.version }})</mat-option
      >
    </mat-select>
    <mat-error *ngIf="posteForm.get('loiCadreId')?.hasError('required')"
      >Loi Cadre is required</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Grade</mat-label>
    <mat-select formControlName="gradeId" aria-label="Select grade">
      <mat-option *ngFor="let grade of grades$ | async" [value]="grade.id"
        >{{ grade.libelle }} ({{ grade.code }})</mat-option
      >
    </mat-select>
    <mat-error *ngIf="posteForm.get('gradeId')?.hasError('required')"
      >Grade is required</mat-error
    >
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>Etablissement</mat-label>
    <mat-select
      formControlName="etablissementId"
      aria-label="Select etablissement"
    >
      <mat-option
        *ngFor="let etablissement of etablissements$ | async"
        [value]="etablissement.id"
        >{{ etablissement.nom }} ({{ etablissement.code }})</mat-option
      >
    </mat-select>
    <mat-error *ngIf="posteForm.get('etablissementId')?.hasError('required')"
      >Etablissement is required</mat-error
    >
  </mat-form-field>
</form>
